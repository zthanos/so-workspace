meta:
  id: RA-RULES-PACK
  version: "1.0"
  mode: "generic-defaults"

system_categories: [legacy, cloud_native, middleware, gateway, cloud_app, data_platform, external]
zones: [onprem_core, cloud_core, perimeter, integration_core, data_platform, external]

routing_rules:
  - id: EXT_INGRESS_GATEWAY
    if: { source_zone: external, target_zone: cloud_core }
    then: { must_route_via: [gateway], disallow_direct: true }

  - id: LEGACY_TO_CLOUD_VIA_MW
    if: { source_category: legacy, target_zone: cloud_core }
    then: { must_route_via: [middleware], preferred_interaction: async, disallow_direct: true }

cross_cutting:
  correlation_required: true
  audit_logging_required: true
  encryption_in_transit: tls12_plus
